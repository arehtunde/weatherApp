{"version":3,"sources":["weather.js"],"names":["_result","require","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","len","length","arr2","Symbol","iterator","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","err","isArray","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","main","document","querySelector","inputfield","wrapper","button","errorInfo","createElement","classList","add","addEventListener","setAttribute","removeAttribute","remove","dialogBox","dialog","append","innerHTML","close","dialoog","showModal","focus","getData","_ref","regeneratorRuntime","mark","_callee","coord","output","load","loader","base","fields","currentUrl","airFields","airUrl","hourlyFields","startTime","endTime","hourlyUrl","dailyFields","startDate","endDate","dailyUrl","_yield$Promise$all","_yield$Promise$all2","currentResponse","airResponse","hourlyResponse","dailyResponse","_yield$Promise$all3","_yield$Promise$all4","currentData","airData","hourlyData","dailyData","wrap","_context","prev","style","display","concat","lat","lng","Date","setHours","getHours","toISOString","setDate","getDate","all","fetch","sent","json","setCurrentTemp","setHourly","setCurrentWeather","setAir","setDaily","console","log","t0","stop","_x","_x2","getCoord","_ref2","_callee2","input","encodedInput","url","fetchCoord","response","data","_context2","trim","encodeURI","results","geometry","components","setHeader"],"mappings":"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","file":"weather.js","sourcesContent":["import {\n  setHeader, setCurrentTemp, setCurrentWeather, setAir, setHourly, setDaily,\n} from './result.js';\n\nconst main = document.querySelector('.main');\nconst inputfield = document.querySelector('.search_input');\nconst wrapper = document.querySelector('.wrapper');\nconst button = document.querySelector('.btn');\n\n// error\nconst errorInfo = document.createElement('div');\nerrorInfo.classList.add('error');\n\ninputfield.addEventListener('input', () => {\n  const input = inputfield.value;\n  if (input.length > 50) {\n    button.setAttribute('disabled', 'disabled');\n    inputfield.classList.add('focus');\n  } else {\n    button.removeAttribute('disabled');\n    inputfield.classList.remove('focus');\n  }\n});\n\nconst dialogBox = () => {\n  const dialog = document.createElement('dialog');\n  dialog.classList.add('dialog');\n  main.append(dialog);\n  dialog.innerHTML = `\n    <h3>You've not provided any input</h3>\n    <p>Please type in a location to get weather report</p>\n    <button class=\"close\">Close</button>\n  `;\n\n  const close = document.querySelector('.close');\n  const dialoog = document.querySelector('.dialog');\n  // activate\n  dialoog.showModal();\n  // close\n  close.addEventListener('click', () => {\n    dialoog.close();\n    dialoog.remove();\n    inputfield.focus();\n  });\n};\n\nconst getData = async (coord, output) => {\n  // loader\n  const load = document.querySelector('.load');\n  const loader = document.querySelector('.loader');\n  main.style.display = 'none';\n  wrapper.innerHTML = '';\n  load.style.display = 'block';\n  loader.style.display = 'block';\n\n  // current weather search params\n  const key = 'vK6swCrrskXqnuZGn4NT7q7Aj1YuZINH';\n  const base = 'https://api.climacell.co/v3/weather/realtime?';\n  const fields = ['precipitation', 'precipitation_type', 'temp', 'feels_like', 'baro_pressure', 'humidity', 'dewpoint', 'visibility', 'moon_phase', 'cloud_cover', 'wind_direction', 'wind_speed', 'weather_code'];\n  const currentUrl = `${base}lat=${coord.lat}&lon=${coord.lng}&fields=${fields}&apikey=${key}`;\n\n  // air quality search params\n  const airFields = ['pm25', 'pm10', 'o3', 'no2', 'co', 'so2', 'epa_aqi', 'epa_health_concern', 'epa_primary_pollutant'];\n  const airUrl = `${base}lat=${coord.lat}&lon=${coord.lng}&fields=${airFields}&apikey=${key}`;\n\n  // hourly weather search params\n  const hourlyFields = ['precipitation_probability', 'temp', 'feels_like', 'baro_pressure', 'humidity', 'wind_speed', 'wind_direction', 'weather_code'];\n  const startTime = new Date();\n  const endTime = new Date(startTime);\n  endTime.setHours(endTime.getHours() + 24);\n  const hourlyUrl = `https://api.climacell.co/v3/weather/forecast/hourly?lat=${coord.lat}&lon=${coord.lng}&start_time=now&end_time=${endTime.toISOString()}&fields=${hourlyFields}&apikey=${key}`;\n\n  // daily weather search params\n  const dailyFields = [...hourlyFields, 'sunrise', 'sunset'];\n  const startDate = new Date();\n  const endDate = new Date(startDate);\n  endDate.setDate(endDate.getDate() + 10);\n  const dailyUrl = `https://api.climacell.co/v3/weather/forecast/daily?lat=${coord.lat}&lon=${coord.lng}&start_time=now&end_time=${endDate.toISOString()}&fields=${dailyFields}&apikey=${key}`;\n\n  try {\n    // fetch data\n    const [currentResponse, airResponse, hourlyResponse, dailyResponse] = await Promise.all([\n      fetch(currentUrl), fetch(airUrl), fetch(hourlyUrl), fetch(dailyUrl),\n    ]);\n\n    const [currentData, airData, hourlyData, dailyData] = await Promise.all([\n      currentResponse.json(), airResponse.json(), hourlyResponse.json(), dailyResponse.json(),\n    ]);\n\n    setCurrentTemp(currentData, output);\n    setHourly(hourlyData);\n    setCurrentWeather(currentData, output);\n    setAir(airData);\n    setDaily(dailyData);\n    console.log(currentData);\n\n    load.style.display = 'none';\n    loader.style.display = 'none';\n    main.style.display = 'block';\n  } catch (error) {\n    errorInfo.innerHTML = `<h3>Oops!</h3>\n    <p>Fail to Fetch</p>\n    <p>Please try again</p>`;\n    wrapper.append(errorInfo);\n  }\n};\n\nconst getCoord = async () => {\n  const input = inputfield.value.trim();\n\n  // const input = inputfield.value.trim();\n  const encodedInput = encodeURI(input);\n  const url = `https://api.opencagedata.com/geocode/v1/json?q=${encodedInput}&key=173f9f1a42c64005be22065050aa936e&pretty=1&limit=1`;\n\n  try {\n    if (!input) {\n      dialogBox();\n    } else {\n      const fetchCoord = fetch(url);\n      const response = await fetchCoord;\n      const data = await response.json();\n\n      // coordinates\n      const coord = data.results[0].geometry;\n      const output = data.results[0].components;\n\n      setHeader(); // set header\n      getData(coord, output);\n    }\n  } catch (err) {\n    wrapper.innerHTML = '';\n    errorInfo.innerHTML = `<h2>${input} Not Found!</h2>\n    <p>Please Enter a valid city name</p>`;\n    wrapper.append(errorInfo);\n  }\n};\n\nbutton.addEventListener('click', getCoord);\n"]}